---
phase: 01-project-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - pyproject.toml
  - src/knowledge_hub/__init__.py
  - src/knowledge_hub/app.py
  - src/knowledge_hub/config.py
  - src/knowledge_hub/models/__init__.py
  - src/knowledge_hub/models/slack.py
  - src/knowledge_hub/models/content.py
  - src/knowledge_hub/models/knowledge.py
  - src/knowledge_hub/models/notion.py
  - src/knowledge_hub/slack/__init__.py
  - src/knowledge_hub/extraction/__init__.py
  - src/knowledge_hub/llm/__init__.py
  - src/knowledge_hub/notion/__init__.py
autonomous: true
requirements: []

must_haves:
  truths:
    - "FastAPI app starts and responds to GET /health with 200 OK"
    - "All 4 Pydantic data models (SlackEvent, ExtractedContent, KnowledgeEntry, NotionPage) are importable from knowledge_hub.models"
    - "Config loading reads environment variables with sensible defaults (empty strings for API keys, 'development' for environment)"
    - "All enums (ContentType, Category, Priority, Status) are defined with correct values"
  artifacts:
    - path: "pyproject.toml"
      provides: "Project metadata, dependencies, build system, tool config"
      contains: "knowledge-hub"
    - path: "src/knowledge_hub/app.py"
      provides: "FastAPI app with lifespan and health endpoint"
      exports: ["app"]
    - path: "src/knowledge_hub/config.py"
      provides: "pydantic-settings configuration loading"
      exports: ["Settings", "get_settings"]
    - path: "src/knowledge_hub/models/slack.py"
      provides: "SlackEvent model"
      contains: "class SlackEvent"
    - path: "src/knowledge_hub/models/content.py"
      provides: "ExtractedContent model and ContentType enum"
      contains: "class ExtractedContent"
    - path: "src/knowledge_hub/models/knowledge.py"
      provides: "KnowledgeEntry model with Category, Priority, Status enums"
      contains: "class KnowledgeEntry"
    - path: "src/knowledge_hub/models/notion.py"
      provides: "NotionPage model with 4-section body"
      contains: "class NotionPage"
  key_links:
    - from: "src/knowledge_hub/app.py"
      to: "src/knowledge_hub/config.py"
      via: "get_settings() in lifespan"
      pattern: "get_settings"
    - from: "src/knowledge_hub/models/__init__.py"
      to: "src/knowledge_hub/models/*.py"
      via: "re-exports all models"
      pattern: "from knowledge_hub\\.models\\.(slack|content|knowledge|notion) import"
---

<objective>
Create the complete Python project scaffold with uv, install all dependencies, define the FastAPI app with health endpoint, configuration loading via pydantic-settings, and all 4 Pydantic data models with their enums.

Purpose: Establish the runnable package structure, importable types, and working health endpoint that all subsequent phases build upon.
Output: A uv-managed Python project with FastAPI app, 4 data models, config loading, and domain package stubs.
</objective>

<execution_context>
@/Users/dbenger/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dbenger/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-project-foundation/01-CONTEXT.md
@.planning/phases/01-project-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize uv project, dependencies, package structure, config, and FastAPI app</name>
  <files>
    pyproject.toml
    src/knowledge_hub/__init__.py
    src/knowledge_hub/app.py
    src/knowledge_hub/config.py
    src/knowledge_hub/slack/__init__.py
    src/knowledge_hub/extraction/__init__.py
    src/knowledge_hub/llm/__init__.py
    src/knowledge_hub/notion/__init__.py
  </files>
  <action>
    **Step 1: Initialize project with uv.**
    Run `uv init --package knowledge-hub` in the project root. This creates `pyproject.toml`, `src/knowledge_hub/__init__.py`, and `.python-version`.

    **Step 2: Edit pyproject.toml.**
    Replace the generated pyproject.toml with the full configuration:
    - `[project]`: name = "knowledge-hub", version = "0.1.0", description = "Slack-to-Notion knowledge base automation pipeline", requires-python = ">=3.12"
    - `dependencies`: fastapi>=0.129.0, uvicorn[standard]>=0.41.0, pydantic-settings>=2.13.0
    - `[dependency-groups] dev`: pytest>=8.0, pytest-asyncio>=1.0.0, httpx>=0.28.0, ruff>=0.9.0
    - `[build-system]`: requires = ["uv_build>=0.10.2,<0.11.0"], build-backend = "uv_build"
    - `[tool.pytest.ini_options]`: asyncio_mode = "auto" (CRITICAL: pytest-asyncio 1.0 changed default to strict)
    - `[tool.ruff]`: target-version = "py312", line-length = 100
    - `[tool.ruff.lint]`: select = ["E", "F", "I", "UP"]

    **Step 3: Install dependencies.**
    Run `uv sync` to install all dependencies and create the lockfile.

    **Step 4: Create config.py.**
    Create `src/knowledge_hub/config.py` with:
    - `Settings(BaseSettings)` class using `SettingsConfigDict(env_file=".env", env_file_encoding="utf-8", case_sensitive=False)`
    - Fields (all with sensible defaults for local dev):
      - `slack_bot_token: str = ""`
      - `slack_signing_secret: str = ""`
      - `notion_api_key: str = ""`
      - `notion_database_id: str = ""`
      - `gemini_api_key: str = ""`
      - `environment: str = "development"`
      - `log_level: str = "INFO"`
      - `port: int = 8080`
    - `get_settings()` function with `@lru_cache` decorator returning `Settings()`
    - IMPORTANT: Do NOT create Settings at module level. Use the lazy `get_settings()` pattern to avoid import-time validation errors.

    **Step 5: Create app.py.**
    Create `src/knowledge_hub/app.py` with:
    - `lifespan` async context manager that calls `get_settings()` and stores in `app.state.settings`
    - `app = FastAPI(title="Knowledge Hub", lifespan=lifespan)`
    - `GET /health` endpoint returning `{"status": "ok", "service": "knowledge-hub", "version": "0.1.0"}`

    **Step 6: Create empty domain package stubs.**
    Create `__init__.py` (empty files) in:
    - `src/knowledge_hub/slack/`
    - `src/knowledge_hub/extraction/`
    - `src/knowledge_hub/llm/`
    - `src/knowledge_hub/notion/`
    These establish the import structure for Phases 2-5.

    **Step 7: Verify the app runs.**
    Run `uv run uvicorn knowledge_hub.app:app --host 127.0.0.1 --port 8080` briefly, then curl `http://127.0.0.1:8080/health` and confirm 200 response with expected JSON. Kill the server after verification.
  </action>
  <verify>
    1. `uv run python -c "from knowledge_hub.app import app; print(app.title)"` prints "Knowledge Hub"
    2. `uv run python -c "from knowledge_hub.config import get_settings; s = get_settings(); print(s.environment)"` prints "development"
    3. Health endpoint returns 200 with `{"status": "ok", "service": "knowledge-hub", "version": "0.1.0"}` (start server briefly, curl, stop)
  </verify>
  <done>
    FastAPI app is importable and starts. Health endpoint returns 200 OK. Config loads from environment with sensible defaults. All 4 domain package stubs exist. uv.lock is generated.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create all Pydantic data models and enums</name>
  <files>
    src/knowledge_hub/models/__init__.py
    src/knowledge_hub/models/slack.py
    src/knowledge_hub/models/content.py
    src/knowledge_hub/models/knowledge.py
    src/knowledge_hub/models/notion.py
  </files>
  <action>
    **Create the models/ sub-package under knowledge_hub/ with 4 model files and a re-export __init__.py.**

    **File 1: src/knowledge_hub/models/slack.py**
    - `SlackEvent(BaseModel)` with fields (per locked decision -- extracted fields only, no raw payload):
      - `channel_id: str`
      - `timestamp: str` (Slack message ts, e.g., "1234567890.123456")
      - `user_id: str`
      - `text: str`
      - `extracted_urls: list[str]` (parsed from Slack `<url|label>` format)
      - `user_note: str | None = None` (non-URL text from the message)

    **File 2: src/knowledge_hub/models/content.py**
    - `ContentType(str, Enum)` with values: ARTICLE = "Article", VIDEO = "Video", NEWSLETTER = "Newsletter", PODCAST = "Podcast", THREAD = "Thread", LINKEDIN_POST = "LinkedIn Post", PDF = "PDF"
    - `ExtractedContent(BaseModel)` with fields (per locked decision -- single model with optional fields):
      - `url: str` (required -- original URL)
      - `content_type: ContentType` (required -- detected type)
      - `title: str | None = None`
      - `author: str | None = None`
      - `source_domain: str | None = None` (e.g., "youtube.com")
      - `text: str | None = None` (main body text / article content)
      - `transcript: str | None = None` (YouTube transcript, None for articles)
      - `description: str | None = None` (meta description or video description)
      - `published_date: str | None = None` (formats vary, keep as string)
      - `word_count: int | None = None`
      - `duration_seconds: int | None = None` (video duration, None for articles)
      - `extraction_method: str | None = None` (e.g., "trafilatura", "youtube-transcript-api")
      - `is_partial: bool = False` (True if paywall detected or extraction incomplete)

    **File 3: src/knowledge_hub/models/knowledge.py**
    - `Category(str, Enum)` with 11 fixed values:
      - AI_ML = "AI & Machine Learning"
      - MARKETING = "Marketing"
      - PRODUCT = "Product"
      - GROWTH = "Growth"
      - ANALYTICS = "Analytics"
      - ENGINEERING = "Engineering"
      - DESIGN = "Design"
      - BUSINESS = "Business"
      - CAREER = "Career"
      - PRODUCTIVITY = "Productivity"
      - OTHER = "Other"
    - `Priority(str, Enum)`: HIGH = "High", MEDIUM = "Medium", LOW = "Low"
    - `Status(str, Enum)`: NEW = "New", REVIEWED = "Reviewed", APPLIED = "Applied", ARCHIVED = "Archived"
    - `KnowledgeEntry(BaseModel)` mirroring the 10 Notion properties exactly (per locked decision):
      - `title: str`
      - `category: Category`
      - `content_type: ContentType` (import from content.py)
      - `source: str` (original URL)
      - `author: str | None = None`
      - `date_added: datetime`
      - `status: Status = Status.NEW`
      - `priority: Priority`
      - `tags: list[str] = []`
      - `summary: str`

    **File 4: src/knowledge_hub/models/notion.py**
    - `NotionPage(BaseModel)` with structured section fields (per locked decision -- each section independently typed):
      - `entry: KnowledgeEntry` (import from knowledge.py -- the 10 properties)
      - `summary_section: str` (3-5 sentence executive summary)
      - `key_points: list[str]` (5-10 numbered statements, importance-ordered)
      - `key_learnings: list[KeyLearning]` (3-7 structured blocks)
      - `detailed_notes: str` (content-type-specific breakdown, ~2500 word cap)
    - `KeyLearning(BaseModel)` helper:
      - `what: str`
      - `why_it_matters: str`
      - `how_to_apply: list[str]` (concrete, sequential steps)

    **File 5: src/knowledge_hub/models/__init__.py**
    - Re-export all public names:
      - From slack: `SlackEvent`
      - From content: `ContentType`, `ExtractedContent`
      - From knowledge: `Category`, `Priority`, `Status`, `KnowledgeEntry`
      - From notion: `KeyLearning`, `NotionPage`
  </action>
  <verify>
    1. `uv run python -c "from knowledge_hub.models import SlackEvent, ExtractedContent, KnowledgeEntry, NotionPage; print('All models importable')"` succeeds
    2. `uv run python -c "from knowledge_hub.models import ContentType, Category, Priority, Status; print(len(Category))"` prints 11
    3. `uv run python -c "from knowledge_hub.models import SlackEvent; e = SlackEvent(channel_id='C123', timestamp='123.456', user_id='U123', text='hello', extracted_urls=['https://example.com']); print(e.channel_id)"` prints "C123"
    4. `uv run python -c "from knowledge_hub.models import KnowledgeEntry, Category, ContentType, Priority; from datetime import datetime; e = KnowledgeEntry(title='Test', category=Category.AI_ML, content_type=ContentType.ARTICLE, source='https://example.com', date_added=datetime.now(), priority=Priority.HIGH, summary='Test summary'); print(e.status)"` prints "Status.NEW" (default status)
  </verify>
  <done>
    All 4 data models are defined with correct field types. All 4 enums (ContentType, Category, Priority, Status) have the correct values. Models are importable from `knowledge_hub.models`. KnowledgeEntry defaults status to NEW. ExtractedContent has optional fields with None defaults.
  </done>
</task>

</tasks>

<verification>
1. `uv run python -c "from knowledge_hub.app import app; print(app.title)"` prints "Knowledge Hub"
2. `uv run python -c "from knowledge_hub.config import get_settings; print(get_settings().environment)"` prints "development"
3. `uv run python -c "from knowledge_hub.models import SlackEvent, ExtractedContent, KnowledgeEntry, NotionPage, ContentType, Category, Priority, Status; print('All imports OK')"` succeeds
4. Health endpoint returns 200 OK when server is started
5. `ls src/knowledge_hub/slack/__init__.py src/knowledge_hub/extraction/__init__.py src/knowledge_hub/llm/__init__.py src/knowledge_hub/notion/__init__.py` -- all 4 domain stubs exist
</verification>

<success_criteria>
- FastAPI app starts and GET /health returns `{"status": "ok", "service": "knowledge-hub", "version": "0.1.0"}`
- All 4 models (SlackEvent, ExtractedContent, KnowledgeEntry, NotionPage) importable from `knowledge_hub.models`
- Config loading via pydantic-settings with sensible defaults (no crash on missing env vars)
- All 4 enums defined: ContentType (7 values), Category (11 values), Priority (3 values), Status (4 values)
- uv.lock exists and `uv sync` succeeds cleanly
- 4 domain package stubs exist (slack/, extraction/, llm/, notion/)
</success_criteria>

<output>
After completion, create `.planning/phases/01-project-foundation/01-01-SUMMARY.md`
</output>
